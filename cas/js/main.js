function initializeCheckboxes(){$("input:radio, input:checkbox").checkedPolyfill(),$("body").on("click",".checkbox input:checkbox",function(){$(this).is(":checked")?$(this).parent().addClass("chacked"):$(this).parent().removeClass("chacked")}),$(".checkbox input:checkbox").each(function(){$(this).is(":checked")?$(this).parent().addClass("chacked"):$(this).parent().removeClass("chacked")})}function checkFieldsGlobal(){function a(a){var b=a.split(".");b[1]-=1;var c=new Date(b[2],b[1],b[0]);return c.getFullYear()==b[2]&&c.getMonth()==b[1]&&c.getDate()==b[0]?!0:!1}function b(a){if(a.hasClass("requiredFieldsDate")){var b=a.val();this.isValidDate(b)===!1?a.closest(".btn_big_rounded").addClass("error_validation"):a.closest(".btn_big_rounded").removeClass("error_validation")}else a.hasClass("requiredFieldsSelect")?a.find("select").val()>0?a.removeClass("error_validation"):a.addClass("error_validation"):a.hasClass("requiredFieldsTitle")?a.text().length<4?a.addClass("error_validation"):a.removeClass("error_validation"):a.hasClass("requiredFieldsImage")?a.find("img").length?a.removeClass("error_validation"):a.addClass("error_validation"):a.hasClass("requiredFieldsCheckBox")?a.find('input[type="checkbox"]').is(":checked")?a.removeClass("error_validation"):a.addClass("error_validation"):a.val().length<4?a.addClass("error_validation"):a.removeClass("error_validation")}return{checkFields:b,isValidDate:a}}$(function(){function a(a){$(".comiseo-daterangepicker").css({top:a.offset().top+a.height(),left:a.offset().left+b,width:a.width()-2*b,"min-width":a.width()-2*b}),$(".datepicker_bottom_block").css({top:a.outerHeight()+$(".comiseo-daterangepicker").outerHeight(),left:b}),a.find(".calendar_block").show()}var b=19;$(".datepicker").length&&($(".datepicker").daterangepicker({datepickerOptions:{numberOfMonths:1,firstDay:1,maxDate:null,onSelect:function(a,b,c){var d="",e="";if(c.start){var f=("0"+c.start.getDate()).slice(-2),g=("0"+(c.start.getMonth()+1)).slice(-2),h=c.start.getFullYear();d=f+"."+g+"."+h}if(c.end){var i=("0"+c.end.getDate()).slice(-2),j=("0"+(c.end.getMonth()+1)).slice(-2),k=c.end.getFullYear();e=i+"."+j+"."+k}$(".calendarWrap.active").find(".calendar_from").val(d),$(".calendarWrap.active").find(".calendar_to").val(e),checkFieldsGlobal.checkFields($(".calendarWrap.active").find(".calendar_from")),checkFieldsGlobal.checkFields($(".calendarWrap.active").find(".calendar_to"))}}}),$(".calendarWrap").on("click",function(b){b.preventDefault();var c=$(this),d=c.find(".datepicker");c.addClass("active"),d.daterangepicker("open"),a(c)}),$(window).resize(function(){var b=$(".calendarWrap");a(b)}),$(document).scroll(function(){var b=$(".calendarWrap"),c=$(document).scrollTop();b=$($(".calendarWrap.active").length?".calendarWrap.active":".calendarWrap"),c>10&&a(b)}),$(".js-reset").on("click",function(){$(".calendarWrap.active").find(".datepicker").daterangepicker("clearRange"),$(".calendarWrap.active").find(".calendar_from").val(""),$(".calendarWrap.active").find(".calendar_to").val("")}))}),$(document).ready(function(){var a=($(this),$(".js-example-basic-single")),b=$(".js-approver_for_request"),c=$(".js-example-basic-multiple"),d=b.data("text");a.select2({minimumResultsForSearch:-1,escapeMarkup:function(a){return a}}),b.select2({minimumResultsForSearch:-1,placeholder:d,escapeMarkup:function(a){return a}}),c.select2({minimumResultsForSearch:-1,escapeMarkup:function(a){return a}})}),$(document).ready(function(){function a(){h=!0,d.find(".navigation_dropdown_block_wrap").animate({opacity:0},f,function(){d.find(".navigation_dropdown_block").animate({height:[0,"easeInOutQuart"]},g,function(){d.removeClass("active"),h=!1})})}function b(a){h=!0,d.addClass("active"),d.find(".navigation_dropdown_block").animate({height:["396px","easeInOutQuart"]},f,function(){d.find(".navigation_dropdown_block_wrap").animate({opacity:1},g,function(){h=!1})})}var c=$(this),d=$(".navigation_dropdown",c),e=$(".navigation_dropdown_block",c),f=500,g=200,h=!1;e.on("click",function(a){a.stopPropagation()}),$(document).scroll(function(){var a=$(document).scrollTop();a>78?($("ul.menu").addClass("scroll"),$(".menu_scroll_wrap").addClass("scrollWrap")):($("ul.menu").removeClass("scroll"),$(".menu_scroll_wrap").removeClass("scrollWrap"))}),initializeCheckboxes(),$("body").on("click",".navigation_dropdown",function(c){if(!h){var d=$(c.currentTarget);d.hasClass("active")?a():b()}}),$("body").on("click",function(b){if(!h){var c=$(b.currentTarget);d.hasClass("active")&&(c.hasClass("navigation_dropdown_block")||e.has(c))&&a()}})});var checkFieldsGlobal=checkFieldsGlobal();$(function(){function a(){d.off("click"),d.remove(),i.removeClass("popup_active")}function b(){$(".requiredFields").each(function(){checkFieldsGlobal.checkFields($(this))})}function c(c){var j=_.template(g);d=$(j({data:c?c:{activity:{},toolbox:{},brand:{},accessManagement:{},adGroups:[]}}));var k=d.find("form");c&&c.id&&k.find('[name="adGroups"]').children().each(function(){var a=$(this);_.where(c.adGroups,a.val()).length&&a.attr("selected","selected")}),d.on("click",".btn-save",function(d){d.preventDefault();var g={id:c?c.id:null,name:k.find('[name="name"]').val(),activity:{view:k.find('[name="activityView"]').is(":checked"),change:k.find('[name="activityChange"]').is(":checked"),approve:k.find('[name="activityApprove"]').is(":checked")},toolbox:{view:k.find('[name="toolboxView"]').is(":checked"),change:k.find('[name="toolboxChange"]').is(":checked"),approve:k.find('[name="toolboxApprove"]').is(":checked")},brand:{view:k.find('[name="brandView"]').is(":checked"),change:k.find('[name="brandChange"]').is(":checked"),approve:k.find('[name="brandApprove"]').is(":checked")},accessManagement:{view:k.find('[name="accessManagementView"]').is(":checked"),change:k.find('[name="accessManagementChange"]').is(":checked"),approve:k.find('[name="accessManagementApprove"]').is(":checked")},adGroups:k.find('[name="adGroups"]').val()};$.ajax({url:k.attr("action"),type:"GET",dataType:"json",data:g,success:function(b){if(!$(".error_validation").length)if(a(),c&&c.id){var d=_.findIndex(accessManagementData,function(a){return a.id==c.id}),i=f.filter('[data-id="'+c.id+'"]');$.extend(accessManagementData[d],g),accessManagementData[d].adGroups=g.adGroups,i.find(".access-management-name").text(c.name),i.find(".access-management-activity-view").text(c.activity.view?"Yes":"No"),i.find(".access-management-activity-change").text(c.activity.change?"Yes":"No"),i.find(".access-management-activity-approve").text(c.activity.approve?"Yes":"No"),i.find(".access-management-ad-groups").html(c.adGroups?c.adGroups.join(", <br>"):""),i.find(".access-management-toolbox-view").text(c.toolbox.view?"Yes":"No"),i.find(".access-management-toolbox-change").text(c.toolbox.change?"Yes":"No"),i.find(".access-management-toolbox-approve").text(c.toolbox.approve?"Yes":"No"),i.find(".access-management-brand-view").text(c.brand.view?"Yes":"No"),i.find(".access-management-brand-change").text(c.brand.change?"Yes":"No"),i.find(".access-management-brand-approve").text(c.brand.approve?"Yes":"No"),i.find(".access-management-access-management-view").text(c.accessManagement.view?"Yes":"No"),i.find(".access-management-access-management-change").text(c.accessManagement.change?"Yes":"No"),i.find(".access-management-access-management-approve").text(c.accessManagement.approve?"Yes":"No")}else{g.id||(g.id=Math.random()+"");var j=_.template(h),k=j({data:b.data?b.data:g,isOdd:f.length%2==0});e.append(k),f=e.find(".access-management-item"),accessManagementData.push(b.data?b.data:g)}},error:function(a){alert("Something went wrong")}}),b()}),d.on("click",".btn-cansel",function(b){b.preventDefault(),a()}),i.addClass("popup_active").append(d),$(".js-example-basic-multiple").select2({minimumResultsForSearch:-1,escapeMarkup:function(a){return a}}),initializeCheckboxes()}var d,e=$(".access-management-block"),f=e.find(".access-management-item"),g=$("#popup-acces-managment-tpl").html(),h=$("#popup-acces-item-tpl").html(),i=$("#popup_block");$(".requiredFields");$(".requiredFields").on("change",function(){checkFieldsGlobal.checkFields($(this))}),$("body").on("change","[contenteditable]",function(){var a=$(this);return a.data("before",a.html()),a}).on("blur keyup paste input","[contenteditable]",function(){var a=$(this);return a.data("before")!==a.html()&&(a.data("before",a.html()),a.trigger("change")),a}),e.on("click",".btn_delete",function(a){a.preventDefault();var b=$(a.currentTarget).closest(".access-management-item"),c=b.data("id");$.ajax({url:"/request.json",type:"GET",dataType:"json",data:{id:c},success:function(){var a=_.findIndex(accessManagementData,function(a){return a.id==c});accessManagementData.splice(a,1),b.remove(),f=e.find(".access-management-item")},error:function(){alert("Something went wrong")}})}),e.on("click",".btn_edit",function(a){a.preventDefault();var b=$(a.currentTarget).closest(".access-management-item").data("id")+"",d=_.where(accessManagementData,{id:b})[0];c(d)}),$(".btn-add-role").on("click",function(a){a.preventDefault(),c()}),i.on("click","#popup_fone",function(){a()}),$("body").on("keyup",".requiredFields",function(){$(this).hasClass("requiredFieldsTitle")||($(this).val().length<4?$(this).addClass("error_validation"):$(this).removeClass("error_validation"))}),$("form").on("submit",function(a){b(),$(".error_validation").length&&a.preventDefault()})}),$(function(){$(document).on("click",function(a){$(".status_wrap")})}),$(function(){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&($(".channel:nth-child(2n+1)").addClass("odd"),$(".document:nth-child(2n+1)").addClass("odd"))}),$(function(){var a=$(this);$tabsNav=$(".tabs_nav",a),$tabsNavItems=$tabsNav.find("li"),$tabsContentWrap=$(".tabs_content"),idx=0,$tabsContentWrap.find("> li:first").addClass("active"),$tabsNavItems.each(function(a,b){$(this).attr("data-page",idx),idx++}),$tabsNavItems.on("click",function(a){a.preventDefault();var b=$(this);idx=b.data("page"),b.addClass("active").siblings().removeClass("active"),$tabsContentWrap.find("> li").eq(idx).addClass("active").siblings().removeClass("active")})}),$(function(){}),$(function(){}),$(function(){}),$(function(){function a(){d.off("click"),d.remove(),e.removeClass("popup_active")}function b(){$(".requiredFields").each(function(){$(this).val().length<4?$(this).addClass("error_validation"):$(this).removeClass("error_validation")})}function c(c){var j=_.template(f);d=$(j({data:c?c:{}}));var k=d.find("form");d.on("click",".btn-save",function(d){d.preventDefault();var e={id:c?c.id:null,subject:k.find('[name="subject"]').val(),text:k.find('[name="text"]').val()};$.ajax({url:k.attr("action"),type:"GET",dataType:"json",data:e,success:function(b){if(!$(".error_validation").length)if(a(),c&&c.id){var d=_.findIndex(emailNotificationsData,function(a){return a.id==c.id}),f=i.filter('[data-id="'+c.id+'"]');$.extend(emailNotificationsData[d],e),f.find(".email-notification-label").text(c.label),f.find(".email-notification-subject").text(c.subject),f.find(".email-notification-text").text(c.text)}else{e.id||(e.id=Math.random()+"");var j=_.template(g),k=j({data:b.data?b.data:e,isOdd:i.length%2==0});h.append(k),i=h.find(".email-notification-item"),emailNotificationsData.push(b.data?b.data:e)}},error:function(a){alert("Something went wrong")}}),b()}),e.addClass("popup_active").append(d)}var d,e=$("#popup_block"),f=$("#edit-notification-tpl").html(),g=$("#email-notification-item-tpl").html(),h=$(".email-notification-block"),i=h.find(".email-notification-item");$(".btn-add-notification").on("click",function(a){a.preventDefault(),c()}),h.on("click",".btn-edit",function(a){a.preventDefault();var b=$(a.currentTarget).closest(".email-notification-item").data("id")+"",d=_.where(emailNotificationsData,{id:b})[0];c(d)}),e.on("click","#popup_fone",function(){a()})}),$(function(){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&$(".wrap_table > div:nth-child(odd)").addClass("odd")}),$(function(){var a=$(".js-uploader");$(".js-basket");a.each(function(){var a=$(this),b=a.text(),c="/img/parlament_bg.jpg",d="123",e="Tititi";new qq.FileUploader({element:this,action:"/server/upload",uploadButtonText:b,allowedExtensions:["jpg","jpeg","png","gif"],onSubmit:function(){a.text("Uploading...")},onComplete:function(f,g,h){if(a.text(b),a.parent().hasClass("block_img"))a.hide(),a.closest(".block_img").append('<img src="'+c+'" alt="">'),a.closest(".requiredFields").removeClass("error_validation");else{var i=_.template($("#template").html());a.closest("form").find(".attachments_block_wrap").append(i({url:c,size:d,name:e}))}}})}),$(".block_img").on("click","img",function(a){a.preventDefault(),$(this).closest(".block_img").find(".js-uploader").trigger("click")}),$("body").on("click",".js-basket",function(a){a.preventDefault(),$(this).closest(".block").remove()}),$(document).on("click",function(a){$(".status_wrap")})}),$(function(){function a(a){return/^[a-zA-Z0-9_\-\.]+@[a-zA-Z0-9\-]+\.[a-zA-Z0-9\-\.]+$/.test(a.val())?void a.removeClass("error_validation").addClass("complete"):(a.focus(),a.addClass("error_validation").removeClass("complete"),!1)}var b=$(".js-mail");b.on("change",function(){var b=$(this);a(b)})}),$(function(){function a(a){return""==a.val()?(a.focus(),a.addClass("error_validation"),!1):a.val().length<4?(a.focus(),a.addClass("error_validation"),!1):/^[a-zA-Z0-9]+$/.test(a.val())?void 0:(a.focus(),a.addClass("error_validation"),!1)}function b(a,b){return""==a.val()||""==b.val()?(b.focus(),!1):void(a.val()!==b.val()?(a.addClass("error_validation"),a.removeClass("complete"),b.addClass("error_validation"),b.removeClass("complete")):(a.removeClass("error_validation"),a.addClass("complete"),b.removeClass("error_validation"),b.addClass("complete")))}var c=$(".password_wrap input");c.on("change",function(){var c=$(this),d=c.parent().siblings("div").find("input");a(c),b(c,d)})}),$(document).ready(function(){$(".ico_star").click(function(){$(this).toggleClass("active")})}),$(document).ready(function(){var a=$(".ico_star"),b=$(".js_search"),c=1e3,d=500,e=!1;a.on("click",function(){$(this).toggleClass("active")}),b.on("click",function(){var a=$(this),b=$(".search_block_wrapper"),f=b.find(".search_block_wrap");e||(a.toggleClass("active"),$("body").animate({scrollTop:b.offset().top},d,function(){f.animate({height:"toggle"},c,function(){e=!1})}))})}),$(function(){var a=$(".js-uploader-image"),b=$(".js-img_wrap");a.each(function(){var a=$(this),b=a.text(),c="/img/parlament_bg.jpg";new qq.FileUploader({element:this,action:"/server/upload",uploadButtonText:b,allowedExtensions:["jpg","jpeg","png","gif"],onSubmit:function(){a.text("Uploading...")},onComplete:function(){a.text(b),a.hide(),a.closest(".js-img_wrap").append('<img src="'+c+'" alt="">')}})}),b.on("click","img",function(a){a.preventDefault(),$(this).closest(".js-img_wrap").find(".js-uploader").trigger("click")})}),$(document).ready(function(){$("body").on("click",".js-basket",function(a){a.preventDefault(),$(this).closest(".block").remove()})}),$(document).ready(function(){$(".ico_star").click(function(){$(this).toggleClass("active")})});